import pandas as pd
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
from docx import Document
from docx.shared import Inches
import os

def plot_correlations_to_doc(df, feature_fields, target_field, output_docx_path="correlation_report.docx"):
    from datetime import datetime
    import tempfile

    skipped_fields = []
    correlations = {}

    # Convert target column to numeric
    df[target_field] = pd.to_numeric(df[target_field], errors='coerce')

    # Create a new Word document
    doc = Document()
    doc.add_heading('Correlation Report', 0)
    doc.add_paragraph(f"Target field: {target_field}")
    doc.add_paragraph(f"Generated on: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}")

    # Create temp directory for plots
    with tempfile.TemporaryDirectory() as tmpdir:
        for feature in feature_fields:
            if feature not in df.columns:
                skipped_fields.append(f"{feature} â€” not found in DataFrame.")
